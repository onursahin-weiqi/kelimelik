<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Kelimelik</title>

<style>
*{
  box-sizing:border-box;
  touch-action:manipulation;
}

body{
  font-family: Arial, sans-serif;
  text-align:center;
  background:#f4f4f4;
  margin:0;
  padding:0;
}

h1{
  margin:20px 0;
  font-size:clamp(28px,6vw,48px);
}

#board{
  margin:10px auto;
  width:95vw;
  max-width:420px;
}

.row{
  display:flex;
}

.tile{
  flex:1;
  aspect-ratio:1/1;
  margin:4px;
  font-size:clamp(18px,5vw,24px);
  font-weight:bold;
  display:flex;
  justify-content:center;
  align-items:center;
  border-radius:6px;
  border:2px solid #ccc;
  background:white;
}

.correct{ background:#2e7d32; color:white; border:none; }
.present{ background:#f9a825; color:white; border:none; }
.absent{ background:#616161; color:white; border:none; }

#keyboard{
  width:100%;
  max-width:500px;
  margin:10px auto 20px auto;
}

.keyRow{
  display:flex;
}

.key{
  flex:1;
  margin:3px;
  height:48px;
  font-size:clamp(12px,3.5vw,16px);
  border:none;
  border-radius:6px;
  background:#ddd;
}

.specialKey{
  flex:1.6;
  margin:3px;
  height:48px;
  font-size:clamp(12px,3.5vw,15px);
  border:none;
  border-radius:6px;
  background:#999;
  color:white;
}

#toast{
  position:fixed;
  top:15px;
  left:50%;
  transform:translateX(-50%);
  background:black;
  color:white;
  padding:10px 18px;
  border-radius:8px;
  display:none;
  font-size:14px;
}
</style>
</head>

<body>

<h1>Kelimelik</h1>

<div id="toast"></div>
<div id="board"></div>
<div id="keyboard"></div>

<script>

let wordList=[];
let target="";
let attempts=0;
let maxAttempts=6;
let currentGuess="";

const keyboardLayout=[
["Q","W","E","R","T","Y","U","I","O","P","Ğ","Ü"],
["A","S","D","F","G","H","J","K","L","Ş","İ"],
["SİL","Z","X","C","V","B","N","M","Ö","Ç","ENTER"]
];

const VALID_LETTERS=[
"A","B","C","Ç","D","E","F","G","Ğ","H",
"I","İ","J","K","L","M","N","O","Ö","P",
"R","S","Ş","T","U","Ü","V","Y","Z"
];

async function loadWords(){
  try{
    const res=await fetch("https://sozluk.gov.tr/autocomplete.json");
    const data=await res.json();

    wordList=data
      .map(w=>w.madde.toLocaleUpperCase("tr-TR"))
      .filter(w=>/^[A-ZÇĞİÖŞÜ]+$/u.test(w) && w.length===5);

    startGame();
  }catch{
    wordList=["GÖREV","TAKIM","YAZIL","KODLA","BİLGİ"];
    startGame();
  }
}

function startGame(){
  target=wordList[Math.floor(Math.random()*wordList.length)];
  attempts=0;
  currentGuess="";
  document.getElementById("board").innerHTML="";
  document.getElementById("keyboard").innerHTML="";
  createBoard();
  createKeyboard();
}

function createBoard(){
  const board=document.getElementById("board");
  for(let r=0;r<6;r++){
    const row=document.createElement("div");
    row.className="row";
    for(let c=0;c<5;c++){
      const tile=document.createElement("div");
      tile.className="tile";
      row.appendChild(tile);
    }
    board.appendChild(row);
  }
}

function createKeyboard(){
  const kb=document.getElementById("keyboard");

  keyboardLayout.forEach(row=>{
    const rowDiv=document.createElement("div");
    rowDiv.className="keyRow";

    row.forEach(letter=>{
      const btn=document.createElement("button");

      if(letter==="ENTER" || letter==="SİL"){
        btn.innerText=letter==="ENTER"?"ENTER":"SİL";
        btn.className="specialKey";
        btn.onclick=()=> letter==="ENTER"?submitGuess():deleteLetter();
      }else{
        btn.innerText=letter;
        btn.className="key";
        btn.onclick=()=> pressKey(letter);
      }

      rowDiv.appendChild(btn);
    });

    kb.appendChild(rowDiv);
  });
}

function pressKey(letter){
  if(currentGuess.length<5){
    currentGuess+=letter;
    updateBoard();
  }
}

function deleteLetter(){
  currentGuess=currentGuess.slice(0,-1);
  updateBoard();
}

function updateBoard(){
  const row=document.getElementById("board").children[attempts];
  for(let i=0;i<5;i++){
    row.children[i].innerText=currentGuess[i]||"";
  }
}

function submitGuess(){

  if(currentGuess.length!==5){
    showToast("5 harf giriniz");
    return;
  }

  if(!wordList.includes(currentGuess)){
    showToast("Geçerli kelime değil");
    return;
  }

  const result=checkGuess();
  const row=document.getElementById("board").children[attempts];

  for(let i=0;i<5;i++){
    row.children[i].classList.add(result[i]);
  }

  if(currentGuess===target){
    showToast("Tebrikler!");
    return;
  }

  attempts++;
  currentGuess="";
}

function checkGuess(){
  const result=Array(5).fill("absent");
  const targetLetters=target.split("");

  for(let i=0;i<5;i++){
    if(currentGuess[i]===target[i]){
      result[i]="correct";
      targetLetters[i]=null;
    }
  }

  for(let i=0;i<5;i++){
    if(result[i]==="correct") continue;
    const index=targetLetters.indexOf(currentGuess[i]);
    if(index!==-1){
      result[i]="present";
      targetLetters[index]=null;
    }
  }

  return result;
}

function showToast(msg){
  const toast=document.getElementById("toast");
  toast.innerText=msg;
  toast.style.display="block";
  setTimeout(()=> toast.style.display="none",2000);
}

document.addEventListener("keydown",(e)=>{

  let key=e.key;

  // Türkçe normalize
  key=key.toLocaleUpperCase("tr-TR");

  if(key==="ENTER") submitGuess();
  else if(key==="BACKSPACE") deleteLetter();
  else if(VALID_LETTERS.includes(key)) pressKey(key);
});

loadWords();

</script>
</body>
</html>
