<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kelimelik</title>

<style>
body{
  font-family: Arial, sans-serif;
  text-align:center;
  background:#f4f4f4;
  margin:0;
  padding:0;
}

h1{
  margin-top:20px;
  font-size:clamp(28px,6vw,48px);
}

#board{
  margin:20px auto;
  width:95vw;
  max-width:420px;
}

.row{
  display:flex;
  justify-content:center;
}

.tile{
  flex:1;
  aspect-ratio:1/1;
  margin:4px;
  font-size:clamp(18px,5vw,24px);
  font-weight:bold;
  display:flex;
  justify-content:center;
  align-items:center;
  border-radius:6px;
  border:2px solid #ccc;
  background:white;
}

.correct{ background:#2e7d32; color:white; border:none; }
.present{ background:#f9a825; color:white; border:none; }
.absent{ background:#616161; color:white; border:none; }

#keyboard{
  margin-top:20px;
  width:100%;
  max-width:500px;
  margin-left:auto;
  margin-right:auto;
}

.keyRow{
  display:flex;
  justify-content:center;
  width:100%;
}

.key{
  flex:1;
  margin:3px;
  height:48px;
  font-size:clamp(12px,3.5vw,16px);
  border:none;
  border-radius:6px;
  background:#ddd;
  cursor:pointer;
}

.key:active{
  transform:scale(0.9);
}

.specialKey{
  flex:1.5;
  margin:3px;
  height:48px;
  font-size:clamp(12px,3.5vw,15px);
  border:none;
  border-radius:6px;
  background:#999;
  color:white;
}

#popupOverlay{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.5);
  display:none;
  justify-content:center;
  align-items:center;
}

#popup{
  background:white;
  padding:25px;
  border-radius:15px;
  width:90%;
  max-width:300px;
}

#shareBtn,#restartBtn{
  margin-top:12px;
  padding:12px;
  width:100%;
  border:none;
  border-radius:10px;
  font-size:16px;
  cursor:pointer;
}

#shareBtn{ background:#388e3c; color:white; }
#restartBtn{ background:#1976d2; color:white; }

#toast{
  position:fixed;
  top:15px;
  left:50%;
  transform:translateX(-50%);
  background:black;
  color:white;
  padding:10px 18px;
  border-radius:8px;
  display:none;
  font-size:14px;
}
</style>
</head>

<body>

<h1>Kelimelik</h1>

<div id="toast"></div>
<div id="board"></div>
<div id="keyboard"></div>

<div id="popupOverlay">
  <div id="popup">
    <h2 id="popupMessage"></h2>
    <button id="shareBtn" onclick="shareResult()">ðŸ“¤ Sonucu PaylaÅŸ</button>
    <button id="restartBtn"></button>
  </div>
</div>

<script>

let wordList=[];
let target="";
let attempts=0;
let maxAttempts=6;
let currentGuess="";
let history=[];

const keyboardLayout=[
["Q","W","E","R","T","Y","U","I","O","P","Äž","Ãœ"],
["A","S","D","F","G","H","J","K","L","Åž","Ä°"],
["SÄ°L","Z","X","C","V","B","N","M","Ã–","Ã‡","ENTER"]
];

const VALID_LETTERS=[
"A","B","C","Ã‡","D","E","F","G","Äž","H",
"I","Ä°","J","K","L","M","N","O","Ã–","P",
"R","S","Åž","T","U","Ãœ","V","Y","Z"
];

async function loadWords(){
  try{
    const res=await fetch("https://sozluk.gov.tr/autocomplete.json");
    const data=await res.json();
    wordList=data
      .map(w=>w.madde.toUpperCase())
      .filter(w=>/^[A-ZÃ‡ÄžÄ°Ã–ÅžÃœ]+$/u.test(w) && w.length===5);
    startGame();
  }catch{
    wordList=["GÃ–REV","TAKIM","YAZIL","KODLA","BÄ°LGÄ°"];
    startGame();
  }
}

function startGame(){
  target=wordList[Math.floor(Math.random()*wordList.length)];
  attempts=0;
  currentGuess="";
  history=[];
  document.getElementById("board").innerHTML="";
  document.getElementById("keyboard").innerHTML="";
  document.getElementById("popupOverlay").style.display="none";
  createBoard();
  createKeyboard();
}

function createBoard(){
  const board=document.getElementById("board");
  for(let r=0;r<6;r++){
    const row=document.createElement("div");
    row.className="row";
    for(let c=0;c<5;c++){
      const tile=document.createElement("div");
      tile.className="tile";
      row.appendChild(tile);
    }
    board.appendChild(row);
  }
}

function createKeyboard(){
  const kb=document.getElementById("keyboard");
  keyboardLayout.forEach(row=>{
    const rowDiv=document.createElement("div");
    rowDiv.className="keyRow";
    row.forEach(letter=>{
      const btn=document.createElement("button");
      if(letter==="ENTER" || letter==="SÄ°L"){
        btn.innerText=letter==="ENTER"?"âŽ ENTER":"âŒ« SÄ°L";
        btn.className="specialKey";
        btn.onclick=()=> letter==="ENTER"?submitGuess():deleteLetter();
      }else{
        btn.innerText=letter;
        btn.className="key";
        btn.onclick=()=> pressKey(letter);
      }
      rowDiv.appendChild(btn);
    });
    kb.appendChild(rowDiv);
  });
}

function pressKey(letter){
  if(currentGuess.length<5){
    currentGuess+=letter;
    updateBoard();
  }
}

function deleteLetter(){
  currentGuess=currentGuess.slice(0,-1);
  updateBoard();
}

function updateBoard(){
  const row=document.getElementById("board").children[attempts];
  for(let i=0;i<5;i++){
    row.children[i].innerText=currentGuess[i]||"";
  }
}

function checkGuess(){
  const result=Array(5).fill("absent");
  const targetLetters=target.split("");
  for(let i=0;i<5;i++){
    if(currentGuess[i]===target[i]){
      result[i]="correct";
      targetLetters[i]=null;
    }
  }
  for(let i=0;i<5;i++){
    if(result[i]==="correct") continue;
    const index=targetLetters.indexOf(currentGuess[i]);
    if(index!==-1){
      result[i]="present";
      targetLetters[index]=null;
    }
  }
  return result;
}

function submitGuess(){
  if(currentGuess.length!==5){
    showToast("5 harf giriniz");
    return;
  }
  if(!wordList.includes(currentGuess)){
    showToast("GeÃ§erli kelime deÄŸil");
    return;
  }

  const result=checkGuess();
  history.push(result);

  const row=document.getElementById("board").children[attempts];
  for(let i=0;i<5;i++){
    row.children[i].classList.add(result[i]);
  }

  if(currentGuess===target){
    endGame(true);
    return;
  }

  attempts++;
  currentGuess="";
  if(attempts===maxAttempts) endGame(false);
}

function endGame(win){
  const popup=document.getElementById("popupOverlay");
  const msg=document.getElementById("popupMessage");
  const restartBtn=document.getElementById("restartBtn");
  popup.style.display="flex";
  msg.innerText=win?"ðŸŽ‰ Tebrikler!":"âŒ Kelime: "+target;
  restartBtn.innerText="Yeni Oyun";
  restartBtn.onclick=startGame;
}

function shareResult(){
  let text=`Kelimelik ${history.length}/6\n`;
  history.forEach(row=>{
    row.forEach(cell=>{
      if(cell==="correct") text+="ðŸŸ©";
      else if(cell==="present") text+="ðŸŸ¨";
      else text+="â¬œ";
    });
    text+="\n";
  });
  navigator.clipboard.writeText(text);
  showToast("Panoya kopyalandÄ±");
}

function showToast(msg){
  const toast=document.getElementById("toast");
  toast.innerText=msg;
  toast.style.display="block";
  setTimeout(()=> toast.style.display="none",2000);
}

document.addEventListener("keydown",(e)=>{
  const key=e.key.toUpperCase();
  if(key==="ENTER") submitGuess();
  else if(key==="BACKSPACE") deleteLetter();
  else if(VALID_LETTERS.includes(key)) pressKey(key);
});

loadWords();

</script>
</body>
</html>
